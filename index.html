<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Family Tree Viewer</title>
  <script src="https://d3js.org/d3.v5.min.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/PeWu/d3-gedcom/d3-gedcom.min.js"></script>
  <style>
    body {
      font-family: sans-serif;
    }
    svg {
      width: 100%;
      height: 100vh;
      border: 1px solid #ccc;
    }
  </style>
</head>
<body>
  <h1>Family Tree</h1>
  <svg id="tree"></svg>

  <script>
    async function loadGedcom() {
      try {
        const response = await fetch('family_tree.ged');  // <-- using .ged here
        if (!response.ok) {
          throw new Error(`HTTP error! Status: ${response.status}`);
        }

        const gedcomText = await response.text();

        const parser = d3_gedcom.GedcomParser();
        const graph = parser.parse(gedcomText);

        const treeLayout = d3.tree().size([window.innerWidth - 40, window.innerHeight - 100]);
        const root = d3.hierarchy(graph, d => d.children);
        treeLayout(root);

        const svg = d3.select("#tree");
        const g = svg.append("g").attr("transform", "translate(20,50)");

        g.selectAll("line")
          .data(root.links())
          .enter()
          .append("line")
          .attr("x1", d => d.source.x)
          .attr("y1", d => d.source.y)
          .attr("x2", d => d.target.x)
          .attr("y2", d => d.target.y)
          .attr("stroke", "#999");

        g.selectAll("text")
          .data(root.descendants())
          .enter()
          .append("text")
          .attr("x", d => d.x)
          .attr("y", d => d.y)
          .attr("dy", ".35em")
          .attr("text-anchor", "middle")
          .text(d => d.data.name)
          .attr("font-size", 12);
      } catch (error) {
        console.error('Failed to load GEDCOM:', error);
        document.body.innerHTML = `<p style="color: red;">Error loading GEDCOM file: ${error.message}</p>`;
      }
    }

    loadGedcom();
  </script>
</body>
</html>
